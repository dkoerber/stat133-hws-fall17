---
title: "hw01-doug-koerber"
author: "Doug Koerber"
date: "9/19/2017"
output: html_document
---

```{r}
load("data/nba2017-salary-points.RData")
ls()
```

### 1) Data Preprocessing
#### Salary in millions of dollars
```{r}
salary_mil = salary / 1000000
salary_mil = round(salary_mil, digits = 2)
```
#### Replacing "R" with 0
```{r}
rookie_logic <- experience == "R"
experience_int = replace(experience, rookie_logic, 0)
experience_int = as.integer(experience_int)
rm(rookie_logic)
```
#### Position Factor
```{r}
center <- position == "C"
pf <- position == "PF"
sg <- position == "SG"
pg <- position == "PG"
sf <- position == "SF"
position_fac = replace(position, center, 'center')
position_fac = replace(position_fac, sf, 'small_fwd')
position_fac = replace(position_fac, pf, 'power_fwd')
position_fac = replace(position_fac, sg, 'shoot_guard')
position_fac = replace(position_fac, pg, 'point_guard')
position_fac = factor(position_fac)
rm(center, pf, sg, pg, sf)
```

##### Position Frequencies
```{r}
table(position_fac)
```

### 2) Scatterplot of Points and Salary
```{r}
plot(points, salary_mil, cex = 1.1, col = rgb(50, 172, 150, maxColorValue = 255), xlab = 'Points', ylab = 'Salary (in millions)', main = 'Scatterplot of Points and Salary')
```

The above plot shows a weak, but noticeable, positive relationship between points and salary.  Most players are clustered below $5,000,000 and 500 points, whereas the league's "all-starts" tend to score more points and receive higher salaries.  Unfortunately, not everyone can be an "all-star."

### 3) Correlation between Points and Salary
For this exercise, _Points_ is assigned to the variable _X_, and _Salary_ is assigned to the variable _Y_.
```{r}
n = 441
xbar = (sum(points)) / n
ybar = (sum(salary_mil)) / n
var_x = (1/(n - 1)) * (sum((points - xbar)^2))
var_y = (1/(n - 1)) * (sum((salary_mil - ybar)^2))
sd_x = sqrt(var_x)
sd_y = sqrt(var_y)
cov_xy = (1/(n - 1)) * (sum((points - xbar)*(salary_mil - ybar)))
cor_xy = cov_xy / (sd_x * sd_y)
```

### 4) Simple Linear Regression
```{r}
b1 = cor_xy * (sd_y / sd_x)
b0 = ybar - (b1 * xbar)
yhat = b0 + (b1 * points)
```


### 5) Plotting the Regression Line
```{r}
plot(points, salary_mil, cex = 1.1, col = rgb(50, 172, 150, maxColorValue = 255), xlab = 'Points', ylab = 'Salary (in millions)', main = 'Scatterplot of Points and Salary', abline(b0, b1, lwd = 2, col = "Red"))
```
