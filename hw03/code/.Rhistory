geom_hline(aes(yintercept = mean(salary))) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue")) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue", size = 4)) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue", size = 2)) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue", size = 1.5)) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue", size = 1)) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue")) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue", size = 0.5)) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary), col = "Blue")) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(yintercept = mean(salary), col = "Blue") +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue") +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 2) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.75) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.75, alpha = 0.6) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.75, alpha = 0.25) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.75, alpha = 0.75) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = "Blue", size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), fill = "Gray") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), fill = "Light Gray") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), fill = gray80) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), fill = "gray80") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), fill = "gray100") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), col = "gray100") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), col = "cornsilk") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), col = "cornsilk3") +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary), col = team) +
geom_bar(stat = "identity") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", col = "gray80") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray80") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gold") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray50") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray75") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray65") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray55") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.5) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.75, alpha = 0.7) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.8, alpha = 0.7) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 1.9, alpha = 0.7) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, points), y = points)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Total Points", y = "Team", title = "NBA Teams Ranked by Total Points")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, points), y = points)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(points)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Total Points", y = "Team", title = "NBA Teams Ranked by Total Points")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Salary (in millions)", y = "Team", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Salary (in millions)", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, points), y = points)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(points)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Total Points", title = "NBA Teams Ranked by Total Points")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, efficiency), y = efficiency)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(points)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Efficiency", title = "NBA Teams Ranked by Total Points")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, efficiency), y = efficiency)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(efficiency)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Efficiency", title = "NBA Teams Ranked by Total Points")
View(teams)
-------------------------------------------------------
# Title: Make teams from data
# Description:
# Input:
# Output:
-------------------------------------------------------
library(readr)
library(dplyr)
library(ggplot2)
setwd("~/Desktop/stat133-hws-fall17/hw03/code")
roster <- read_csv("../data/nba2017-roster.csv")
stats <- read_csv("../data/nba2017-stats.csv")
stats <- mutate(stats, missed_fg = field_goals_atts - field_goals_made,
missed_ft = points1_atts - points1_made,
points = points1_made + (2 * points2_made) + (3 * points3_made),
rebounds = off_rebounds + def_rebounds,
efficiency = (points + rebounds + assists + steals + blocks
- missed_fg - missed_ft - turnovers) / games_played)
sink(file = "../output/efficiency-summary.txt")
summary(stats[ , 'efficiency'])
sink()
roster_stats <- inner_join(roster, stats)
teams <- roster_stats %>%
group_by(team) %>%
summarise(experience = round(sum(experience), 2),
salary = round(sum(salary) / 1000000, 2),
points3 = sum(points3_made),
points2 = sum(points2_made),
free_throws = sum(field_goals_made),
points = sum(points),
off_rebounds = sum(off_rebounds),
def_rebounds = sum(def_rebounds),
assists = sum(assists),
blocks = sum(blocks),
turnovers = sum(turnovers),
fouls = sum(fouls),
efficiency = sum(efficiency)
)
sink(file = "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, file = "../data/nba2017-teams.csv", row.names = FALSE)
pdf(file = "../images/teams_star_plot.pdf", width = 7, height = 5)
stars(teams[ ,-1], labels = teams$team)
dev.off()
pdf(file = "../images/experience-salary.pdf")
ggplot(data = teams, aes(x = experience, y = salary)) +
geom_point() +
geom_label(aes(label = team))
dev.off()
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, efficiency), y = efficiency)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(efficiency)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Efficiency", title = "NBA Teams Ranked by Total Points")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, points), y = points)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(points)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Total Points", title = "NBA Teams Ranked by Total Points")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, salary), y = salary)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(salary)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Salary (in millions)", title = "NBA Teams Ranked by Total Salary")
library(ggplot2)
ggplot(data = teams, aes(x = reorder(team, efficiency), y = efficiency)) +
geom_bar(stat = "identity", fill = "gray60") +
geom_hline(aes(yintercept = mean(efficiency)), col = rgb(50, 172, 150, maxColorValue = 255), size = 2, alpha = 0.7) +
coord_flip() +
labs(x = "Team", y = "Total Efficiency", title = "NBA Teams Ranked by Total Points")
?prcomp
prcomp(points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls)
prcomp(data = teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls)
View(teams)
prcomp(data = teams, scale. = TRUE)
prcomp(teams, scale. = TRUE)
prcomp(teams, scale. = TRUE)
prcomp(points3, scale. = TRUE)
prcomp(teams$points3, scale. = TRUE)
scale(teams)
me <- scale(teams)
me <- scale(teams$)
prcomp(teams, scale. = TRUE)
str(teams)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
View(teams)
-------------------------------------------------------
# Title: Make teams from data
# Description:
# Input:
# Output:
-------------------------------------------------------
library(readr)
library(dplyr)
library(ggplot2)
setwd("~/Desktop/stat133-hws-fall17/hw03/code")
roster <- read_csv("../data/nba2017-roster.csv")
stats <- read_csv("../data/nba2017-stats.csv")
stats <- mutate(stats, missed_fg = field_goals_atts - field_goals_made,
missed_ft = points1_atts - points1_made,
points = points1_made + (2 * points2_made) + (3 * points3_made),
rebounds = off_rebounds + def_rebounds,
efficiency = (points + rebounds + assists + steals + blocks
- missed_fg - missed_ft - turnovers) / games_played)
sink(file = "../output/efficiency-summary.txt")
summary(stats[ , 'efficiency'])
sink()
roster_stats <- inner_join(roster, stats)
teams <- roster_stats %>%
group_by(team) %>%
summarise(experience = round(sum(experience), 2),
salary = round(sum(salary) / 1000000, 2),
points3 = sum(points3_made),
points2 = sum(points2_made),
free_throws = sum(field_goals_made),
points = sum(points),
off_rebounds = sum(off_rebounds),
def_rebounds = sum(def_rebounds),
assists = sum(assists),
steals = sum(steals),
blocks = sum(blocks),
turnovers = sum(turnovers),
fouls = sum(fouls),
efficiency = sum(efficiency)
)
sink(file = "../data/teams-summary.txt")
summary(teams)
sink()
write.csv(teams, file = "../data/nba2017-teams.csv", row.names = FALSE)
pdf(file = "../images/teams_star_plot.pdf", width = 7, height = 5)
stars(teams[ ,-1], labels = teams$team)
dev.off()
pdf(file = "../images/experience-salary.pdf")
ggplot(data = teams, aes(x = experience, y = salary)) +
geom_point() +
geom_label(aes(label = team))
dev.off()
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
prcomp(pc1, scale. = TRUE)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdve^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3))
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdv^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3))
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdev^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdev, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdev^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdev^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = round(cumsum(pca$sdev^2)))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdev^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = round(100 * pca$sdev^2 / cumsum(pca$sdev^2), 3))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = pca$sdev^2, proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = round(pca$sdev^2 / cumsum(pca$sdev^2), 3))
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = round(pca$sdev^2, 3), proportion = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = round(pca$sdev^2 / cumsum(pca$sdev^2), 3))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = round(pca$sdev^2, 3), proportion = round(pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = round(pca$sdev^2 / cumsum(pca$sdev^2), 3))
View(eigs)
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = round(pca$sdev^2, 3), proportion = round(pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = cumsum(proportion))
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = round(pca$sdev^2, 3), proportion = round(pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = cumsum(proportion))
pc1 <- data.frame(teams$points3, teams$points2, teams$free_throws, teams$off_rebounds, teams$def_rebounds, teams$assists, teams$steals, teams$blocks, teams$turnovers, teams$fouls)
pca <- prcomp(pc1, scale. = TRUE)
names(pca)
eigs <- data.frame(eigenvalue = round(pca$sdev^2, 3), proportion = round(pca$sdev^2 / sum(pca$sdev^2), 3), cumprop = cumsum(eigs$proportion))
View(eigs)
